<!-- frontend/src/app/dashboard/dashboard.component.html -->
<div class="p-2 md:p-4 grid grid-cols-1 md:grid-cols-4 gap-4 md:gap-6" *ngIf="metrics">
  <mat-card class="animate-card">
    <mat-card-content class="flex items-center p-4">
      <div class="p-3 rounded-full mr-4 bg-[var(--mat-sys-primary-container)]">
        <mat-icon class="scale-125 text-[var(--mat-sys-on-primary-container)]">point_of_sale</mat-icon>
      </div>
      <div>
        <p class="text-sm opacity-70 font-medium">Ventas Hoy</p>
        <h3 class="text-2xl font-bold">{{ metrics.ventasHoy | currency:'MXN' }}</h3>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card class="animate-card">
    <mat-card-content class="flex items-center p-4">
      <div class="p-3 rounded-full mr-4 bg-[var(--mat-sys-secondary-container)]">
        <mat-icon class="scale-125 text-[var(--mat-sys-on-secondary-container)]">account_balance_wallet</mat-icon>
      </div>
      <div>
        <p class="text-sm opacity-70 font-medium">Por Cobrar</p>
        <h3 class="text-2xl font-bold">{{ metrics.porCobrar | currency:'MXN' }}</h3>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card class="animate-card">
    <mat-card-content class="flex items-center p-4">
      <div class="p-3 rounded-full mr-4 bg-[var(--mat-sys-tertiary-container)]">
        <mat-icon class="scale-125 text-[var(--mat-sys-on-tertiary-container)]">money_off</mat-icon>
      </div>
      <div>
        <p class="text-sm opacity-70 font-medium">Por Pagar</p>
        <h3 class="text-2xl font-bold">{{ metrics.porPagar | currency:'MXN' }}</h3>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card class="animate-card">
    <mat-card-content class="flex items-center p-4">
      <div class="p-3 rounded-full mr-4 bg-[var(--mat-sys-error-container)]">
        <mat-icon class="scale-125 text-[var(--mat-sys-on-error-container)]">warning</mat-icon>
      </div>
      <div>
        <p class="text-sm opacity-70 font-medium">Stock Bajo</p>
        <h3 class="text-2xl font-bold">{{ metrics.conteoBajos }} prod.</h3>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card class="md:col-span-3 animate-card">
    <mat-card-header><mat-card-title>Tendencia de Ventas (7 D铆as)</mat-card-title></mat-card-header>
    <mat-card-content class="h-[300px] flex items-center justify-center mt-4">
      <div *ngIf="graficaVentas.length > 0; else noData" class="w-full h-full">
        <ngx-charts-area-chart [results]="graficaVentas" [scheme]="colorVentas" [gradient]="true" [xAxis]="true" [yAxis]="true" [showXAxisLabel]="true" xAxisLabel="Fecha" yAxisLabel="Venta ($)" [autoScale]="true"></ngx-charts-area-chart>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card class="md:col-span-1 animate-card">
    <mat-card-header><mat-card-title>Flujo de Dinero</mat-card-title></mat-card-header>
    <mat-card-content class="h-[300px] flex items-center justify-center mt-4">
      <ngx-charts-bar-vertical [results]="graficaFlujo" [scheme]="colorFlujo" [xAxis]="true" [yAxis]="true" [showXAxisLabel]="false" [showYAxisLabel]="true" [showDataLabel]="true"></ngx-charts-bar-vertical>
    </mat-card-content>
  </mat-card>

  <mat-card class="md:col-span-2 animate-card">
    <mat-card-header><mat-card-title> Top 5 M谩s Vendidos</mat-card-title></mat-card-header>
    <mat-card-content class="h-[250px] flex items-center justify-center mt-4">
      <div *ngIf="graficaTop.length > 0; else noData" class="w-full h-full">
        <ngx-charts-bar-horizontal [results]="graficaTop" [scheme]="colorTop" [xAxis]="true" [yAxis]="true" [showXAxisLabel]="true" [showYAxisLabel]="true" xAxisLabel="Cantidad Vendida"></ngx-charts-bar-horizontal>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card class="md:col-span-2 animate-card responsive-table">
    <mat-card-header><mat-card-title>锔 Alerta de Reabastecimiento</mat-card-title></mat-card-header>
    <mat-card-content class="mt-2 overflow-auto h-[250px]">
      <table mat-table [dataSource]="metrics.listaBajos" class="w-full">
        <ng-container matColumnDef="codigo">
          <th mat-header-cell *matHeaderCellDef>C贸d</th>
          <td mat-cell *matCellDef="let e" data-label="C贸digo">{{e.codigo}}</td>
        </ng-container>
        <ng-container matColumnDef="descripcion">
          <th mat-header-cell *matHeaderCellDef>Descripci贸n</th>
          <td mat-cell *matCellDef="let e" class="text-xs font-medium" data-label="Descripci贸n">{{e.descripcion}}</td>
        </ng-container>
        <ng-container matColumnDef="existencia">
          <th mat-header-cell *matHeaderCellDef>Stock</th>
          <td mat-cell *matCellDef="let e" class="font-bold text-right pr-4" data-label="Stock">{{e.existencia}}</td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </mat-card-content>
  </mat-card>

  <ng-template #noData>
    <div class="flex flex-col items-center justify-center h-full opacity-50">
      <mat-icon class="scale-150 mb-2">bar_chart</mat-icon>
      <p>No hay datos suficientes a煤n.</p>
    </div>
  </ng-template>
</div>
